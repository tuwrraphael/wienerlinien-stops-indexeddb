{"version":3,"file":"index.js","sources":["../src/utils.ts","../src/constants.ts","../src/bounding-coordinates.ts","../src/stop-store.ts","../src/process-stream.ts","../src/split-csv-line.ts","../src/haversine.ts","../src/order-stops-by-distance.ts"],"sourcesContent":["export const toRad = x => x * (Math.PI / 180);\r\nexport const toDeg = x => x / (Math.PI / 180);","export const EARTH_RADIUS = 6371.01;","import { toRad, toDeg } from \"./utils\";\r\nimport { EARTH_RADIUS } from \"./constants\";\r\n\r\nconst MAX_LAT = Math.PI / 2;\r\nconst MIN_LAT = -MAX_LAT;\r\nconst MAX_LON = Math.PI; \r\nconst MIN_LON = -MAX_LON;\r\nconst FULL_CIRCLE_RAD = Math.PI * 2;\r\n\r\nexport function boundingCoordinates(lat, lon, distance) {\r\n    lat = toRad(lat);\r\n    lon = toRad(lon);\r\n    let radDist = distance / EARTH_RADIUS,\r\n        minLat = lat - radDist,\r\n        maxLat = lat + radDist,\r\n        minLon,\r\n        maxLon,\r\n        deltaLon;\r\n    if (minLat > MIN_LAT && maxLat < MAX_LAT) {\r\n        deltaLon = Math.asin(Math.sin(radDist) / Math.cos(lat));\r\n        minLon = lon - deltaLon;\r\n        if (minLon < MIN_LON) {\r\n            minLon += FULL_CIRCLE_RAD;\r\n        }\r\n        maxLon = lon + deltaLon;\r\n        if (maxLon > MAX_LON) {\r\n            maxLon -= FULL_CIRCLE_RAD;\r\n        }\r\n    } else {\r\n        minLat = Math.max(minLat, MIN_LAT);\r\n        maxLat = Math.min(maxLat, MAX_LAT);\r\n        minLon = MIN_LON;\r\n        maxLon = MAX_LON;\r\n    }\r\n    return [toDeg(minLat), toDeg(minLon), toDeg(maxLat), toDeg(maxLon)];\r\n};","import { processStream } from \"./process-stream\";\r\nimport { boundingCoordinates } from \"./bounding-coordinates\";\r\nimport { Stop } from \"./stop\";\r\n\r\nconst STATION_URL = \"https://www.data.wien.gv.at/txt/wrlinien-gtfs-stops.txt\";\r\nconst WEEK = 7 * 24 * 60 * 60 * 1000;\r\n\r\nexport class StopStore {\r\n\r\n    constructor(private dbName: string) {\r\n    }\r\n\r\n    async import(saveStops) {\r\n        let res = await fetch(STATION_URL);\r\n        const bodyAsTextStream = res.body.pipeThrough(new TextDecoderStream());\r\n        await processStream(bodyAsTextStream, saveStops);\r\n    }\r\n\r\n    query(lat, lng, r) {\r\n        const [minLat, minLon, maxLat, maxLon] = boundingCoordinates(lat, lng, r / 1000);\r\n        return new Promise<Stop[]>((resolve, reject) => {\r\n            let lat_range = IDBKeyRange.bound(minLat, maxLat);\r\n            let long_range = IDBKeyRange.bound(minLon, maxLon);\r\n            this.openDb().then(db => {\r\n                let tx = db.transaction(\"Stops\");\r\n                let obj_store = tx.objectStore(\"Stops\");\r\n                let res = [];\r\n                let results = [];\r\n                let lat_request = obj_store.index('stop_lat').getAllKeys(lat_range);\r\n                let lng_request = obj_store.index('stop_lon').getAllKeys(long_range);\r\n                function provideResults() {\r\n                    let tx = db.transaction(\"Stops\");\r\n                    let obj_store = tx.objectStore(\"Stops\");\r\n                    let objs = [];\r\n                    results.forEach(v => {\r\n                        let request = obj_store.get(v);\r\n                        request.onsuccess = () => {\r\n                            objs.push(request.result);\r\n                            if (objs.length == results.length) {\r\n                                resolve(objs);\r\n                            }\r\n                        };\r\n                        request.onerror = err => reject(err);\r\n                    });\r\n                }\r\n                lat_request.onsuccess = () => {\r\n                    if (res.length) {\r\n                        results = lat_request.result.filter(s => res.indexOf(s) > -1);\r\n                        provideResults();\r\n                    }\r\n                    res = lat_request.result;\r\n                }\r\n                lat_request.onerror = err => reject(err);\r\n                lng_request.onsuccess = () => {\r\n                    if (res.length) {\r\n                        results = lng_request.result.filter(s => res.indexOf(s) > -1);\r\n                        provideResults();\r\n                    }\r\n                    res = lng_request.result;\r\n                }\r\n                lng_request.onerror = err => reject(err);\r\n            }, err => reject(err));\r\n        });\r\n    }\r\n\r\n    queryByName(name) {\r\n        return new Promise<Stop[]>((resolve, reject) => {\r\n            this.openDb().then(db => {\r\n                let tx = db.transaction(\"Stops\");\r\n                let obj_store = tx.objectStore(\"Stops\");\r\n                let request = obj_store.openCursor();\r\n                let results = [];\r\n                request.onsuccess = function () {\r\n                    var cursor = request.result;\r\n                    if (cursor) {\r\n                        if (cursor.value.stop_name.indexOf(name) !== -1) {\r\n                            results.push(cursor.value);\r\n                        }\r\n                        cursor.continue();\r\n                    }\r\n                    else {\r\n                        resolve(results);\r\n                    }\r\n                };\r\n                request.onerror = err => reject(err);\r\n            });\r\n        });\r\n    }\r\n\r\n    openDb(): Promise<IDBDatabase> {\r\n        let self = this;\r\n        return new Promise((resolve, reject) => {\r\n            let request = window.indexedDB.open(self.dbName, 2);\r\n            request.onsuccess = function () {\r\n                resolve(request.result);\r\n            }\r\n            request.onupgradeneeded = function (ev) {\r\n                if (ev.oldVersion < 2) {\r\n                    let stopStore = request.result.createObjectStore(\"Stops\", { keyPath: \"stop_id\" });\r\n                    stopStore.createIndex(\"stop_lat\", \"stop_lat\", { unique: false });\r\n                    stopStore.createIndex(\"stop_lon\", \"stop_lon\", { unique: false });\r\n                    stopStore.createIndex('version', ['version'], { unique: false });\r\n                    request.result.createObjectStore(\"Logs\", { keyPath: \"id\" });\r\n                }\r\n            }\r\n            request.onerror = function (err) {\r\n                reject(err);\r\n            }\r\n        });\r\n    }\r\n\r\n    getLogEntry(): Promise<{ version: number, updated: number }> {\r\n        return new Promise((resolve, reject) => {\r\n            this.openDb().then(db => {\r\n                let tx = db.transaction(\"Logs\");\r\n                let logsStore = tx.objectStore(\"Logs\");\r\n                let request = logsStore.get(0);\r\n                request.onsuccess = () => resolve(<{ version: number, updated: number }>request.result || { version: 0, updated: 0 });\r\n                request.onerror = err => reject(err);\r\n            }, err => reject(err));\r\n        });\r\n    }\r\n\r\n    async maintainDb() {\r\n        let db = await this.openDb();\r\n        let logEntry = await this.getLogEntry();\r\n        if (+new Date() - logEntry.updated < WEEK) {\r\n            return;\r\n        }\r\n        logEntry.version++;\r\n        await this.import(function (stops) {\r\n            let tx = db.transaction(\"Stops\", \"readwrite\");\r\n            let stopStore = tx.objectStore(\"Stops\");\r\n            for (let stop of stops) {\r\n                stopStore.put({ ...stop, version: logEntry.version });\r\n            }\r\n        });\r\n        let tx = db.transaction(\"Stops\", \"readwrite\");\r\n        let stopStore = tx.objectStore(\"Stops\");\r\n        var pdestroy = stopStore.index(\"version\").openKeyCursor(IDBKeyRange.only(logEntry.version - 1));\r\n        pdestroy.onsuccess = function () {\r\n            var cursor = pdestroy.result;\r\n            if (cursor) {\r\n                stopStore.delete(cursor.primaryKey);\r\n                cursor.continue;\r\n            }\r\n        }\r\n        tx = db.transaction(\"Logs\", \"readwrite\");\r\n        let logStore = tx.objectStore(\"Logs\");\r\n        logStore.put({ id: 0, updated: +new Date(), version: logEntry.version });\r\n    }\r\n}","import { splitCsvLine } from \"./split-csv-line\";\r\n\r\nexport function processStream(bodyAsTextStream: ReadableStream, saveStops) {\r\n    return new Promise((resolve, reject) => {\r\n        let accumulate = \"\";\r\n        let header = false;\r\n        let map = { stop_id: 0, stop_name: 0, stop_lat: 0, stop_lon: 0 };\r\n        let numProps = Object.keys(map).length;\r\n        const appendStream = new WritableStream({\r\n            write(chunk) {\r\n                let stops = [];\r\n                accumulate += chunk;\r\n                let incomplete = false;\r\n                let splitted = accumulate.replace(/\\r/g, \"\").split(\"\\n\");\r\n                splitted.map(stopString => {\r\n                    let stopSplitted = Array.from(splitCsvLine(stopString, \",\"));\r\n                    if (!header || accumulate.length < 2) {\r\n                        for (let prop in map) {\r\n                            if (map.hasOwnProperty(prop)) {\r\n                                map[prop] = stopSplitted.indexOf(prop);\r\n                            }\r\n                        }\r\n                        header = true;\r\n                    }\r\n                    if (header && stopSplitted.length >= numProps) {\r\n                        stops.push({\r\n                            stop_id: stopSplitted[map.stop_id],\r\n                            stop_name: stopSplitted[map.stop_name],\r\n                            stop_lat: parseFloat(stopSplitted[map.stop_lat]),\r\n                            stop_lon: parseFloat(stopSplitted[map.stop_lon])\r\n                        });\r\n                    } else {\r\n                        incomplete = true;\r\n                    }\r\n                });\r\n                if (incomplete) {\r\n                    accumulate = splitted[splitted.length - 1];\r\n                }\r\n                else {\r\n                    accumulate = \"\";\r\n                }\r\n                if (stops.length) {\r\n                    saveStops(stops);\r\n                }\r\n            },\r\n            close: function () {\r\n                resolve();\r\n            },\r\n            abort: function () {\r\n                reject();\r\n            }\r\n        });\r\n        bodyAsTextStream.pipeTo(appendStream);\r\n    });\r\n}","export function* splitCsvLine(str, symbol) {\r\n    let splitted = str.split(symbol);\r\n    let accumulate = \"\";\r\n    for (let s of splitted) {\r\n        s = accumulate + s;\r\n        if (s[0] == \"\\\"\") {\r\n            if (s[s.length - 1] == \"\\\"\" && (s.length <= 2 || s[s.length - 2] != \"\\\"\")) {\r\n                yield s.substring(1, s.length - 1);\r\n                accumulate = \"\";\r\n            }\r\n            else {\r\n                accumulate += s;\r\n            }\r\n        } else {\r\n            yield s;\r\n            accumulate = \"\";\r\n        }\r\n    }\r\n    if (accumulate.length) {\r\n        yield accumulate;\r\n    }\r\n}","import { toRad } from \"./utils\";\r\nimport { EARTH_RADIUS } from \"./constants\";\r\n\r\nexport function haversine([lat1, lon1], [lat2, lon2]) {\r\n    var x1 = lat2 - lat1;\r\n    var dLat = toRad(x1);\r\n    var x2 = lon2 - lon1;\r\n    var dLon = toRad(x2);\r\n    var a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +\r\n        Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) *\r\n        Math.sin(dLon / 2) * Math.sin(dLon / 2);\r\n    var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n    return EARTH_RADIUS * c;\r\n}\r\n","import { Stop } from \"./stop\";\r\nimport { haversine } from \"./haversine\";\r\n\r\nexport function orderStopsByDistance(stops: Stop[], lat, lng) {\r\n    return stops\r\n        .map(v => {\r\n            return {\r\n                stop: v,\r\n                d: haversine([v.stop_lat, v.stop_lon], [lat, lng])\r\n            }\r\n        })\r\n        .sort((a, b) => a.d - b.d)\r\n        .map(v => v.stop);\r\n}"],"names":["toRad","x","Math","PI","toDeg","EARTH_RADIUS","MAX_LAT","MIN_LAT","MAX_LON","MIN_LON","FULL_CIRCLE_RAD","STATION_URL","WEEK","StopStore","[object Object]","dbName","this","saveStops","bodyAsTextStream","fetch","body","pipeThrough","TextDecoderStream","Promise","resolve","reject","accumulate","header","map","stop_id","stop_name","stop_lat","stop_lon","numProps","Object","keys","length","appendStream","WritableStream","chunk","stops","incomplete","splitted","replace","split","stopString","stopSplitted","Array","from","str","symbol","s","substring","splitCsvLine","prop","hasOwnProperty","indexOf","push","parseFloat","close","abort","pipeTo","processStream","lat","lng","r","minLat","minLon","maxLat","maxLon","lon","distance","deltaLon","radDist","asin","sin","cos","max","min","boundingCoordinates","lat_range","IDBKeyRange","bound","long_range","openDb","then","db","obj_store","transaction","objectStore","res","results","lat_request","index","getAllKeys","lng_request","provideResults","objs","forEach","v","request","get","onsuccess","result","onerror","err","filter","name","openCursor","cursor","value","continue","self","window","indexedDB","open","onupgradeneeded","ev","oldVersion","stopStore","createObjectStore","keyPath","createIndex","unique","version","updated","logEntry","getLogEntry","Date","import","stop","put","tx","pdestroy","openKeyCursor","only","delete","primaryKey","id","haversine","lat1","lon1","lat2","lon2","dLat","dLon","a","c","atan2","sqrt","orderStopsByDistance","d","sort","b"],"mappings":"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"}